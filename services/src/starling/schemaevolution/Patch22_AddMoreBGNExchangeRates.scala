package starling.schemaevolution

import system.Patch
import starling.db.DBWriter
import starling.richdb.RichDB
import starling.daterange.Day
import starling.services.StarlingInit


class Patch22_AddMoreBGNExchangeRates extends Patch {

  protected def runPatch(starlingInit: StarlingInit, starling: RichDB, writer: DBWriter) = {
    /**
     * The rates added in patch 22 where inverted by mistake
     */
    writer.update(
      """
        delete from SnapshotData
        where
        dataTypeKey = 'spotFX'
        and subTypeKey =  'BGN'
      """)
    AddBGNExchangeRates(starling, writer, Patch22_AddMoreBGNExchangeRates.historicRates)
  }

  def patchDescription = "Remove incorrect USD/BGN rates and replace with correct ones"
}

object Patch22_AddMoreBGNExchangeRates {
  val historicRates = Map(
    Day(2009, 12, 24) -> .73506,
    Day(2009, 12, 25) -> .73603,
    Day(2009, 12, 26) -> .73603,
    Day(2009, 12, 27) -> .73488,
    Day(2009, 12, 28) -> .73490,
    Day(2009, 12, 29) -> .73380,
    Day(2009, 12, 30) -> .73304,
    Day(2009, 12, 31) -> .73227,
    Day(2010, 1, 1) -> .73565,
    Day(2010, 1, 2) -> .73485,
    Day(2010, 1, 3) -> .73245,
    Day(2010, 1, 4) -> .73684,
    Day(2010, 1, 5) -> .73425,
    Day(2010, 1, 6) -> .73397,
    Day(2010, 1, 7) -> .73140,
    Day(2010, 1, 8) -> .73657,
    Day(2010, 1, 9) -> .73639,
    Day(2010, 1, 10) -> .73670,
    Day(2010, 1, 11) -> .74209,
    Day(2010, 1, 12) -> .74102,
    Day(2010, 1, 13) -> .74146,
    Day(2010, 1, 14) -> .74131,
    Day(2010, 1, 15) -> .73572,
    Day(2010, 1, 16) -> .73587,
    Day(2010, 1, 17) -> .73349,
    Day(2010, 1, 18) -> .73560,
    Day(2010, 1, 19) -> .73056,
    Day(2010, 1, 20) -> .72135,
    Day(2010, 1, 21) -> .72013,
    Day(2010, 1, 22) -> .72289,
    Day(2010, 1, 23) -> .72355,
    Day(2010, 1, 24) -> .72358,
    Day(2010, 1, 25) -> .72349,
    Day(2010, 1, 26) -> .71986,
    Day(2010, 1, 27) -> .71762,
    Day(2010, 1, 28) -> .71384,
    Day(2010, 1, 29) -> .70887,
    Day(2010, 1, 30) -> .70883,
    Day(2010, 1, 31) -> .70878,
    Day(2010, 2, 1) -> .71238,
    Day(2010, 2, 2) -> .71430,
    Day(2010, 2, 3) -> .71031,
    Day(2010, 2, 4) -> .70201,
    Day(2010, 2, 5) -> .69933,
    Day(2010, 2, 6) -> .69567,
    Day(2010, 2, 7) -> .69820,
    Day(2010, 2, 8) -> .69815,
    Day(2010, 2, 9) -> .70536,
    Day(2010, 2, 10) -> .70212,
    Day(2010, 2, 11) -> .70022,
    Day(2010, 2, 12) -> .69717,
    Day(2010, 2, 13) -> .69621,
    Day(2010, 2, 14) -> .69619,
    Day(2010, 2, 15) -> .69530,
    Day(2010, 2, 16) -> .70351,
    Day(2010, 2, 17) -> .69622,
    Day(2010, 2, 18) -> .68997,
    Day(2010, 2, 19) -> .69608,
    Day(2010, 2, 20) -> .69204,
    Day(2010, 2, 21) -> .69598,
    Day(2010, 2, 22) -> .69546,
    Day(2010, 2, 23) -> .69087,
    Day(2010, 2, 24) -> .69221,
    Day(2010, 2, 25) -> .69234,
    Day(2010, 2, 26) -> .69665,
    Day(2010, 2, 27) -> .69838,
    Day(2010, 2, 28) -> .69631,
    Day(2010, 3, 1) -> .69362,
    Day(2010, 3, 2) -> .69586,
    Day(2010, 3, 3) -> .70019,
    Day(2010, 3, 4) -> .69423,
    Day(2010, 3, 5) -> .69637,
    Day(2010, 3, 6) -> .69567,
    Day(2010, 3, 7) -> .69735,
    Day(2010, 3, 8) -> .69679,
    Day(2010, 3, 9) -> .69540,
    Day(2010, 3, 10) -> .69816,
    Day(2010, 3, 11) -> .69931,
    Day(2010, 3, 12) -> .70390,
    Day(2010, 3, 13) -> .70390,
    Day(2010, 3, 14) -> .70381,
    Day(2010, 3, 15) -> .69922,
    Day(2010, 3, 16) -> .70422,
    Day(2010, 3, 17) -> .70227,
    Day(2010, 3, 18) -> .69572,
    Day(2010, 3, 19) -> .69193,
    Day(2010, 3, 20) -> .69193,
    Day(2010, 3, 21) -> .69180,
    Day(2010, 3, 22) -> .69362,
    Day(2010, 3, 23) -> .69001,
    Day(2010, 3, 24) -> .68127,
    Day(2010, 3, 25) -> .67932,
    Day(2010, 3, 26) -> .68560,
    Day(2010, 3, 27) -> .68468,
    Day(2010, 3, 28) -> .68940,
    Day(2010, 3, 29) -> .68891,
    Day(2010, 3, 30) -> .68627,
    Day(2010, 3, 31) -> .69059,
    Day(2010, 4, 1) -> .69457,
    Day(2010, 4, 2) -> .69029,
    Day(2010, 4, 3) -> .69029,
    Day(2010, 4, 4) -> .68993,
    Day(2010, 4, 5) -> .68935,
    Day(2010, 4, 6) -> .68485,
    Day(2010, 4, 7) -> .68205,
    Day(2010, 4, 8) -> .68313,
    Day(2010, 4, 9) -> .69041,
    Day(2010, 4, 10) -> .69041,
    Day(2010, 4, 11) -> .69693,
    Day(2010, 4, 12) -> .69466,
    Day(2010, 4, 13) -> .69623,
    Day(2010, 4, 14) -> .69797,
    Day(2010, 4, 15) -> .69438,
    Day(2010, 4, 16) -> .69039,
    Day(2010, 4, 17) -> .68952,
    Day(2010, 4, 18) -> .68915,
    Day(2010, 4, 19) -> .68977,
    Day(2010, 4, 20) -> .68727,
    Day(2010, 4, 21) -> .68441,
    Day(2010, 4, 22) -> .67932,
    Day(2010, 4, 23) -> .68427,
    Day(2010, 4, 24) -> .68427,
    Day(2010, 4, 25) -> .68239,
    Day(2010, 4, 26) -> .68473,
    Day(2010, 4, 27) -> .67281,
    Day(2010, 4, 28) -> .67514,
    Day(2010, 4, 29) -> .67716,
    Day(2010, 4, 30) -> .67965,
    Day(2010, 5, 1) -> .68006,
    Day(2010, 5, 2) -> .68160,
    Day(2010, 5, 3) -> .67442,
    Day(2010, 5, 4) -> .66317,
    Day(2010, 5, 5) -> .65549,
    Day(2010, 5, 6) -> .64573,
    Day(2010, 5, 7) -> .65250,
    Day(2010, 5, 8) -> .65051,
    Day(2010, 5, 9) -> .66171,
    Day(2010, 5, 10) -> .65379,
    Day(2010, 5, 11) -> .64593,
    Day(2010, 5, 12) -> .64606,
    Day(2010, 5, 13) -> .64031,
    Day(2010, 5, 14) -> .63199,
    Day(2010, 5, 15) -> .63199,
    Day(2010, 5, 16) -> .63150,
    Day(2010, 5, 17) -> .63430,
    Day(2010, 5, 18) -> .62241,
    Day(2010, 5, 19) -> .63518,
    Day(2010, 5, 20) -> .63754,
    Day(2010, 5, 21) -> .64331,
    Day(2010, 5, 22) -> .64331,
    Day(2010, 5, 23) -> .64136,
    Day(2010, 5, 24) -> .63108,
    Day(2010, 5, 25) -> .63257,
    Day(2010, 5, 26) -> .62139,
    Day(2010, 5, 27) -> .63178,
    Day(2010, 5, 28) -> .62726,
    Day(2010, 5, 29) -> .63221,
    Day(2010, 5, 30) -> .62817,
    Day(2010, 5, 31) -> .62931,
    Day(2010, 6, 1) -> .62418,
    Day(2010, 6, 2) -> .62612,
    Day(2010, 6, 3) -> .62188,
    Day(2010, 6, 4) -> .61195,
    Day(2010, 6, 5) -> .61338,
    Day(2010, 6, 6) -> .61071,
    Day(2010, 6, 7) -> .60933,
    Day(2010, 6, 8) -> .61175,
    Day(2010, 6, 9) -> .61276,
    Day(2010, 6, 10) -> .61907,
    Day(2010, 6, 11) -> .61932,
    Day(2010, 6, 12) -> .61968,
    Day(2010, 6, 13) -> .61970,
    Day(2010, 6, 14) -> .62438,
    Day(2010, 6, 15) -> .62989,
    Day(2010, 6, 16) -> .62888,
    Day(2010, 6, 17) -> .63301,
    Day(2010, 6, 18) -> .63349,
    Day(2010, 6, 19) -> .63262,
    Day(2010, 6, 20) -> .63555,
    Day(2010, 6, 21) -> .63011
    )
}